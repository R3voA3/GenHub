<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="clr-namespace:GenHub.Features.GameProfiles.ViewModels"
             xmlns:models="clr-namespace:GenHub.Core.Models.Enums;assembly=GenHub.Core"
             xmlns:conv="clr-namespace:GenHub.Infrastructure.Converters"
             mc:Ignorable="d" d:DesignWidth="700" d:DesignHeight="600"
             x:Class="GenHub.Features.GameProfiles.Views.GameProfileContentEditorView"
             x:DataType="vm:GameProfileSettingsViewModel">

    <UserControl.Resources>
        <conv:ContrastTextColorConverter x:Key="ContrastTextColorConverter" />
        <conv:ColorToBrushConverter x:Key="ColorToBrushConverter" />
        <conv:ThemeBackgroundConverter x:Key="ThemeBackgroundConverter" />
        <conv:ThemeBorderConverter x:Key="ThemeBorderConverter" />
        <conv:BoolToColorConverter x:Key="BoolToColorConverter" />
        <conv:BoolToStatusColorConverter x:Key="BoolToStatusColorConverter" />
        <conv:StringToImageConverter x:Key="StringToImageConverter" />
        <conv:NotNullConverter x:Key="NotNullConverter" />
        <conv:NotNullOrEmptyConverter x:Key="NotNullOrEmptyConverter" />
        <conv:NullSafePropertyConverter x:Key="NullSafeConverter" />
        <conv:NullToVisibilityConverter x:Key="NullToVisibilityConverter" />
        <conv:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter" />
        <conv:InvertedBoolToVisibilityConverter x:Key="InvertedBoolToVisibilityConverter" />
        <conv:TabIndexToVisibilityConverter x:Key="TabIndexToVisibilityConverter" />
        <conv:EqualityConverter x:Key="EqualityConverter" />
    </UserControl.Resources>

    <UserControl.Styles>
        <!-- Section card style -->
        <Style Selector="Border.section-card">
            <Setter Property="Background" Value="#50FFFFFF" />
            <Setter Property="BorderBrush" Value="#60FFFFFF" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="CornerRadius" Value="10" />
            <Setter Property="Padding" Value="16" />
            <Setter Property="Margin" Value="0,0,0,12" />
            <Setter Property="TextElement.Foreground" Value="White" />
        </Style>

        <!-- Section title -->
        <Style Selector="TextBlock.section-title">
            <Setter Property="FontSize" Value="15" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Margin" Value="0,0,0,12" />
        </Style>

        <!-- Content action buttons -->
        <Style Selector="Button.btn-add">
            <Setter Property="Background" Value="#15FFFFFF" />
            <Setter Property="BorderBrush" Value="#40FFFFFF" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Foreground" Value="#9575CD" />
            <Setter Property="CornerRadius" Value="6" />
            <Setter Property="Padding" Value="14,6" />
            <Setter Property="FontSize" Value="12" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Cursor" Value="Hand" />
        </Style>
        <Style Selector="Button.btn-add:pointerover /template/ ContentPresenter">
            <Setter Property="Background" Value="#9575CD" />
            <Setter Property="BorderBrush" Value="#9575CD" />
            <Setter Property="Foreground" Value="White" />
        </Style>

        <!-- Content filter pills -->
        <Style Selector="Button.filter-pill">
            <Setter Property="Background">
                <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                    <GradientStop Offset="0" Color="#50FFFFFF"/>
                    <GradientStop Offset="0.5" Color="#20FFFFFF"/>
                    <GradientStop Offset="1" Color="#05FFFFFF"/>
                </LinearGradientBrush>
            </Setter>
            <Setter Property="Margin" Value="4" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="BorderBrush">
                <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                    <GradientStop Offset="0" Color="#D0FFFFFF"/>
                    <GradientStop Offset="1" Color="#40FFFFFF"/>
                </LinearGradientBrush>
            </Setter>
            <Setter Property="BorderThickness" Value="1.5" />
            <Setter Property="CornerRadius" Value="10" />
            <Setter Property="Padding" Value="16,10" />
            <Setter Property="MinWidth" Value="110" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="HorizontalContentAlignment" Value="Center" />
            <Setter Property="FontWeight" Value="SemiBold" />
        </Style>

        <!-- Hover: Brighten the 'glass' significantly. RenderTransform moved to Button to avoid clipping -->
        <Style Selector="Button.filter-pill:pointerover /template/ ContentPresenter">
            <Setter Property="Background" Value="#50000000" />
            <Setter Property="BorderBrush" Value="#FFFFFFFF" />
        </Style>

        <Style Selector="Button.filter-pill:pointerover">
            <Setter Property="RenderTransform" Value="translateY(-2px)" />
            <Setter Property="ZIndex" Value="10" />
        </Style>

        <Style Selector="Button.filter-pill:pressed">
             <Setter Property="RenderTransform" Value="scale(0.96)" />
        </Style>

        <Style Selector="Button.filter-pill.selected /template/ ContentPresenter" x:CompileBindings="False">
            <Setter Property="Background" Value="{Binding $parent[UserControl].DataContext.ColorValue, Converter={StaticResource ColorToBrushConverter}}" />
            <Setter Property="BorderBrush">
                 <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                    <GradientStop Offset="0" Color="#FFFFFFFF"/>
                    <GradientStop Offset="1" Color="#AAFFFFFF"/>
                </LinearGradientBrush>
            </Setter>
            <Setter Property="Opacity" Value="1" />
        </Style>

        <Style Selector="Button.filter-pill.selected">
            <Setter Property="ZIndex" Value="1" />
            <Setter Property="BorderThickness" Value="2" />
        </Style>

        <!-- Selected text gets a strong shadow to pop against the colored background -->
        <Style Selector="Button.filter-pill.selected TextBlock">
            <Setter Property="Foreground" Value="White" />
            <Setter Property="FontWeight" Value="Bold" />
             <Setter Property="Effect">
                 <DropShadowEffect BlurRadius="4" Color="Black" Opacity="0.5" OffsetX="0" OffsetY="2" />
            </Setter>
        </Style>

        <Style Selector="Button.filter-pill.selected PathIcon">
            <Setter Property="Foreground" Value="White" />
             <Setter Property="Effect">
                 <DropShadowEffect BlurRadius="4" Color="Black" Opacity="0.5" OffsetX="0" OffsetY="2" />
            </Setter>
        </Style>

        <!-- New Content Card Styles -->
        <Style Selector="Button.content-card-btn">
            <Setter Property="Background" Value="#08FFFFFF" />
            <Setter Property="BorderBrush" Value="#15FFFFFF" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="CornerRadius" Value="8" />
            <Setter Property="Padding" Value="12" />
            <Setter Property="Margin" Value="4" />
            <Setter Property="MinWidth" Value="250" />
            <Setter Property="MaxWidth" Value="400" />
            <Setter Property="HorizontalContentAlignment" Value="Stretch" />
            <Setter Property="VerticalContentAlignment" Value="Stretch" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Transitions">
                <Transitions>
                    <BrushTransition Property="Background" Duration="0:0:0.1" />
                    <BrushTransition Property="BorderBrush" Duration="0:0:0.1" />
                </Transitions>
            </Setter>
        </Style>
        <Style Selector="Button.content-card-btn:pointerover">
            <Setter Property="Background" Value="#12FFFFFF" />
            <Setter Property="BorderBrush" Value="#40FFFFFF" />
        </Style>
        <Style Selector="Button.content-card-btn:pointerover /template/ ContentPresenter">
            <Setter Property="Background" Value="#12FFFFFF" />
            <Setter Property="BorderBrush" Value="#40FFFFFF" />
        </Style>

        <!-- Style to show children on hover -->
        <Style Selector="Button.action-reveal-btn">
            <Setter Property="Opacity" Value="0" />
            <Setter Property="Transitions">
                <Transitions>
                    <DoubleTransition Property="Opacity" Duration="0:0:0.15" />
                </Transitions>
            </Setter>
        </Style>

        <!-- When parent card is hovered, reveal the delete button -->
        <Style Selector="Grid.content-card:pointerover Button.action-reveal-btn">
            <Setter Property="Opacity" Value="1" />
        </Style>

        <!-- Ensure the delete button itself reacts to its own hover -->
        <Style Selector="Button.action-reveal-btn:pointerover">
            <Setter Property="Opacity" Value="1" />
            <Setter Property="Background" Value="#40FFFFFF" />
        </Style>
    </UserControl.Styles>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="190" />
            <ColumnDefinition Width="4" />
            <ColumnDefinition Width="*" MinWidth="0" />
        </Grid.ColumnDefinitions>

        <!-- Sidebar Navigation -->
        <Border Grid.Column="0"
                Background="#10000000"
                BorderBrush="#20FFFFFF"
                BorderThickness="0,0,1,0"
                Padding="12,24">
            <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                <StackPanel Spacing="2">
                    <Button Classes="sidebar-btn"
                            Classes.selected="{Binding SelectedContentEditorCategory, Converter={StaticResource EqualityConverter}, ConverterParameter={x:Static vm:ContentEditorCategory.EnabledContent}}"
                            Command="{Binding SelectContentEditorCategoryCommand}"
                            CommandParameter="{x:Static vm:ContentEditorCategory.EnabledContent}">
                        <StackPanel Orientation="Horizontal">
                            <PathIcon Data="M9,10A3.04,3.04 0 0,1 12,7A3.04,3.04 0 0,1 15,10A3.04,3.04 0 0,1 12,13A3.04,3.04 0 0,1 9,10M12,19L16,20V16.92A7.54,7.54 0 0,1 12,18A7.54,7.54 0 0,1 8,16.92V20M12,4A5.78,5.78 0 0,0 7.76,5.74A5.78,5.78 0 0,0 6,10A5.78,5.78 0 0,0 7.76,14.23A5.78,5.78 0 0,0 12,16A5.78,5.78 0 0,0 16.24,14.23A5.78,5.78 0 0,0 18,10A5.78,5.78 0 0,0 16.24,5.74A5.78,5.78 0 0,0 12,4M20,10A8.04,8.04 0 0,1 19.43,12.8A7.84,7.84 0 0,1 18,15.28V23L12,21L6,23V15.28A7.9,7.9 0 0,1 4,10A7.68,7.68 0 0,1 6,4.47A7.73,7.73 0 0,1 12,2A7.73,7.73 0 0,1 18,4.47A7.68,7.68 0 0,1 20,10Z" />
                            <TextBlock Text="Enabled" VerticalAlignment="Center" />
                        </StackPanel>
                    </Button>

                    <Button Classes="sidebar-btn"
                            Classes.selected="{Binding SelectedContentEditorCategory, Converter={StaticResource EqualityConverter}, ConverterParameter={x:Static vm:ContentEditorCategory.AvailableContent}}"
                            Command="{Binding SelectContentEditorCategoryCommand}"
                            CommandParameter="{x:Static vm:ContentEditorCategory.AvailableContent}">
                        <StackPanel Orientation="Horizontal">
                            <PathIcon Data="M19,20H4C2.89,20 2,19.1 2,18V6C2,4.89 2.89,4 4,4H10L12,6H19A2,2 0 0,1 21,8H21L4,8V18L6.14,10H23.21L20.93,18.5C20.7,19.37 19.92,20 19,20Z" />
                            <TextBlock Text="Available" VerticalAlignment="Center" />
                        </StackPanel>
                    </Button>
                </StackPanel>
            </ScrollViewer>
        </Border>

        <!-- Resizer -->
        <GridSplitter Grid.Column="1" Background="Transparent" ResizeDirection="Columns" />

        <!-- Content Area -->
        <ScrollViewer x:Name="ContentEditorScrollViewer" Grid.Column="2" Padding="4"
                      VerticalScrollBarVisibility="Auto"
                      HorizontalScrollBarVisibility="Disabled"
                      BringIntoViewOnFocusChange="False">
            <StackPanel Spacing="0" Margin="0,0,10,0">

                <!-- Enabled Content Section -->
                <Control x:Name="EnabledContentSection" Height="1" Margin="0,-1,0,0" />
                <Border Classes="section-card"
                        Background="{Binding ColorValue, Converter={StaticResource ThemeBackgroundConverter}, Mode=OneWay}"
                        BorderBrush="{Binding ColorValue, Converter={StaticResource ThemeBorderConverter}, Mode=OneWay}">
                    <StackPanel>
                        <Grid ColumnDefinitions="*,Auto">
                            <TextBlock Grid.Column="0" Classes="section-title" Text="Enabled Content" Margin="0" />
                            <Button Grid.Column="1" Content="âŸ³ Refresh"
                                    Command="{Binding LoadAvailableContentCommand}"
                                    Background="Transparent"
                                    Padding="8,4"
                                    FontSize="11"
                                    VerticalAlignment="Top" />
                        </Grid>

                        <!-- Warning if no content -->
                        <Border Background="#30FF9800" CornerRadius="6" Padding="12" Margin="0,4,0,8"
                                IsVisible="{Binding EnabledContent.Count, Converter={x:Static ObjectConverters.Equal}, ConverterParameter=0}">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <TextBlock Text="âš ï¸" FontSize="14" />
                                <TextBlock Text="No content enabled. Add at least one Game Client (Executable) to launch this profile."
                                           FontSize="12" Opacity="0.9" TextWrapping="Wrap" VerticalAlignment="Center" />
                            </StackPanel>
                        </Border>

                        <!-- Enabled content list -->
                        <ItemsControl ItemsSource="{Binding EnabledContent}">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <WrapPanel Orientation="Horizontal" HorizontalAlignment="Center" />
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Grid ColumnDefinitions="*,Auto" Classes="content-card">
                                        <Button Grid.Column="0" Grid.ColumnSpan="2"
                                                Classes="content-card-btn"
                                                Command="{Binding $parent[ItemsControl].((vm:GameProfileSettingsViewModel)DataContext).DisableContentCommand}"
                                                CommandParameter="{Binding}"
                                                ToolTip.Tip="Click to remove from profile">
                                            <StackPanel Spacing="6" HorizontalAlignment="Left" VerticalAlignment="Center">
                                                <TextBlock Text="{Binding DisplayName}" FontWeight="SemiBold" FontSize="13" TextTrimming="CharacterEllipsis" />
                                                <WrapPanel Orientation="Horizontal" Margin="0,0,8,0">
                                                     <Border Background="#20FF5252" BorderBrush="#FF5252" BorderThickness="1" CornerRadius="4" Padding="6,2" Margin="0,0,4,4"
                                                            IsVisible="{Binding Publisher, Converter={x:Static StringConverters.IsNotNullOrEmpty}}">
                                                        <TextBlock Text="{Binding Publisher}" FontSize="10" Foreground="#FF8A80" FontWeight="SemiBold" />
                                                    </Border>
                                                    <Border Background="#20FFFFFF" BorderBrush="#40FFFFFF" BorderThickness="1" CornerRadius="4" Padding="6,2" Margin="0,0,4,4">
                                                        <TextBlock Text="{Binding GameType, Converter={x:Static conv:GameTypeShortDisplayConverter.Instance}}" FontSize="10" Foreground="#E0E0E0" />
                                                    </Border>
                                                    <Border Background="#20FFFFFF" BorderBrush="#40FFFFFF" BorderThickness="1" CornerRadius="4" Padding="6,2" Margin="0,0,4,4">
                                                        <TextBlock Text="{Binding ContentType, Converter={x:Static conv:ContentTypeDisplayConverter.Instance}}" FontSize="10" Foreground="#E0E0E0" />
                                                    </Border>
                                                </WrapPanel>
                                            </StackPanel>
                                        </Button>

                                        <!-- Edit Button (Only for Local/Editable content) -->
                                        <Button Grid.Column="1"
                                                Classes="action-reveal-btn"
                                                Command="{Binding $parent[ItemsControl].((vm:GameProfileSettingsViewModel)DataContext).EditContentCommand}"
                                                CommandParameter="{Binding}"
                                                IsVisible="{Binding IsEditable}"
                                                Background="Transparent" BorderThickness="0"
                                                Padding="8" Margin="0,0,12,0"
                                                VerticalAlignment="Center"
                                                AutomationProperties.Name="Edit Content"
                                                ToolTip.Tip="Edit Content">
                                            <PathIcon Data="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"
                                                      Width="14" Height="14" Foreground="#9575CD" />
                                        </Button>
                                    </Grid>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </StackPanel>
                </Border>

                <!-- Add Content Section -->
                <Control x:Name="AvailableContentSection" Height="1" Margin="0,-1,0,0" />
                <Border Classes="section-card"
                        Background="{Binding ColorValue, Converter={StaticResource ThemeBackgroundConverter}, Mode=OneWay}"
                        BorderBrush="{Binding ColorValue, Converter={StaticResource ThemeBorderConverter}, Mode=OneWay}">
                    <StackPanel>
                        <TextBlock Classes="section-title" Text="Add Content" />

                        <!-- Content type filter pills -->
                        <ItemsControl ItemsSource="{Binding VisibleFilters}" Margin="0,0,0,12">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <WrapPanel HorizontalAlignment="Center" />
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate x:DataType="vm:GameProfileSettingsViewModel+FilterTypeInfo">
                                    <Button Classes="filter-pill"
                                            Command="{Binding $parent[ItemsControl].((vm:GameProfileSettingsViewModel)DataContext).SelectContentTypeFilterCommand}"
                                            CommandParameter="{Binding ContentType}">
                                        <Classes.selected>
                                            <MultiBinding Converter="{StaticResource EqualityConverter}">
                                                <Binding Path="ContentType" />
                                                <Binding Path="$parent[ItemsControl].((vm:GameProfileSettingsViewModel)DataContext).SelectedContentType" />
                                            </MultiBinding>
                                        </Classes.selected>
                                        <StackPanel Orientation="Horizontal" Spacing="6">
                                            <PathIcon Data="{Binding IconData}" Width="16" Height="16" />
                                            <TextBlock Text="{Binding DisplayName}" FontSize="12" />
                                        </StackPanel>
                                    </Button>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>

                        <!-- Action Row: Add Local and Game Type Toggle -->
                        <Grid ColumnDefinitions="Auto,*" Margin="0,0,0,12">
                            <Button Grid.Column="0" Classes="filter-pill" Content="ðŸ“ Add Local"
                                    Command="{Binding AddLocalContentCommand}"
                                    Background="#15FFFFFF" BorderBrush="#40FFFFFF"
                                    AutomationProperties.Name="Add Local"
                                    ToolTip.Tip="Import content from disk" />

                            <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right" Spacing="0">
                                <TextBlock Text="Filter Game:" VerticalAlignment="Center" Margin="0,0,8,0" Opacity="0.7" FontSize="12" />
                                <Button Classes="filter-pill left" Content="Generals"
                                        Classes.selected="{Binding GameTypeFilter, Converter={StaticResource EqualityConverter}, ConverterParameter={x:Static models:GameType.Generals}}"
                                        Command="{Binding SelectGameTypeFilterCommand}"
                                        CommandParameter="{x:Static models:GameType.Generals}" />
                                <Button Classes="filter-pill right" Content="Zero Hour"
                                        Classes.selected="{Binding GameTypeFilter, Converter={StaticResource EqualityConverter}, ConverterParameter={x:Static models:GameType.ZeroHour}}"
                                        Command="{Binding SelectGameTypeFilterCommand}"
                                        CommandParameter="{x:Static models:GameType.ZeroHour}" />
                            </StackPanel>
                        </Grid>

                        <!-- Available Content List -->
                        <ItemsControl ItemsSource="{Binding AvailableContent}">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <WrapPanel Orientation="Horizontal" HorizontalAlignment="Center" />
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Grid ColumnDefinitions="*,Auto" Classes="content-card">
                                        <Button Grid.Column="0" Grid.ColumnSpan="2"
                                                Classes="content-card-btn"
                                                Command="{Binding $parent[ItemsControl].((vm:GameProfileSettingsViewModel)DataContext).EnableContentCommand}"
                                                CommandParameter="{Binding}"
                                                ToolTip.Tip="Click to add to profile">
                                            <StackPanel Spacing="6" HorizontalAlignment="Left" VerticalAlignment="Center">
                                                <TextBlock Text="{Binding DisplayName}" FontWeight="SemiBold" FontSize="13" TextTrimming="CharacterEllipsis" />
                                                <WrapPanel Orientation="Horizontal" Margin="0,0,8,0">
                                                    <Border Background="#204CAF50" BorderBrush="#4CAF50" BorderThickness="1" CornerRadius="4" Padding="6,2" Margin="0,0,4,4"
                                                            IsVisible="{Binding Publisher, Converter={x:Static StringConverters.IsNotNullOrEmpty}}">
                                                        <TextBlock Text="{Binding Publisher}" FontSize="10" Foreground="#A5D6A7" FontWeight="SemiBold" />
                                                    </Border>
                                                    <Border Background="#20FFFFFF" BorderBrush="#40FFFFFF" BorderThickness="1" CornerRadius="4" Padding="6,2" Margin="0,0,4,4">
                                                        <TextBlock Text="{Binding GameType, Converter={x:Static conv:GameTypeShortDisplayConverter.Instance}}" FontSize="10" Foreground="#E0E0E0" />
                                                    </Border>
                                                    <Border Background="#20FFFFFF" BorderBrush="#40FFFFFF" BorderThickness="1" CornerRadius="4" Padding="6,2" Margin="0,0,4,4">
                                                        <TextBlock Text="{Binding ContentType, Converter={x:Static conv:ContentTypeDisplayConverter.Instance}}" FontSize="10" Foreground="#E0E0E0" />
                                                    </Border>
                                                </WrapPanel>
                                            </StackPanel>
                                        </Button>

                                        <!-- Edit Button (Only for Local/Editable content) -->
                                        <Button Grid.Column="1"
                                                Classes="action-reveal-btn"
                                                Command="{Binding $parent[ItemsControl].((vm:GameProfileSettingsViewModel)DataContext).EditContentCommand}"
                                                CommandParameter="{Binding}"
                                                IsVisible="{Binding IsEditable}"
                                                Background="Transparent" BorderThickness="0"
                                                Padding="8" Margin="0,0,12,0"
                                                VerticalAlignment="Center"
                                                AutomationProperties.Name="Edit Content"
                                                ToolTip.Tip="Edit Content">
                                            <PathIcon Data="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"
                                                      Width="14" Height="14" Foreground="#9575CD" />
                                        </Button>
                                    </Grid>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </StackPanel>
                </Border>
                <Panel Height="80" /> <!-- Bottom Spacer -->
            </StackPanel>
        </ScrollViewer>
    </Grid>
</UserControl>
